<div *ngIf="course$ | async as result">
  <ng-container *ngIf="result.error; else showCourse">
    <p class="text-red-600 text-center text-lg">{{ result.error }}</p>
  </ng-container>

  <ng-template #showCourse>
    <div *ngIf="result.data as course" class="max-w-5xl mx-auto mt-12 px-6 pb-16">
      
   
      <div class="flex justify-between items-start border-b pb-6 mb-6">
        <div>
          <h1 class="text-3xl font-bold text-gray-900">{{ course.title }}</h1>
          <p class="text-gray-600 mt-1">{{ course.description }}</p>
          <p class="text-sm text-gray-500 mt-2">
            By <span class="font-semibold">{{ course.instructorName }}</span> â€¢ 
            Created on {{ course.createdAt | date: 'mediumDate' }}
          </p>
        </div>
      </div>

    
      <div *ngIf="course.firstUploadedFile" class="mb-8">
        <h2 class="text-xl font-semibold text-gray-800 mb-2">Preview: {{ course.firstUploadedFile.topic }}</h2>
        <p class="text-gray-600 mb-4">{{ course.firstUploadedFile.description }}</p>
        <!-- <video
          width="100%"
          height="360"
          controls
          [src]="getVideoUrl(course.firstUploadedFile.fileName)"
        
        ></video> -->
<!-- course.firstUploadedFile.path -->
        <video  width="100%"
          height="360"
          controls   class="rounded-md shadow-md" [src]="'http://localhost:5295' + course.firstUploadedFile.path"></video>

      </div>

 
      <div class="bg-gray-50 border rounded-md p-6 shadow-inner">
        <h3 class="text-2xl font-semibold text-gray-800 mb-4">
          {{ course.isEnrolled ? 'Full Course Content' : 'ðŸ”’ Full Course Content (Locked)' }}
        </h3>

        <div class="space-y-3">
          <div *ngFor="let file of course.uploadedFiles">
            <div
              class="flex justify-between items-center p-3 bg-gray-100 rounded hover:bg-gray-200 transition"
            >
              <div>
                <span class="text-gray-800 font-medium">{{ file.topic }}</span>
                <p class="text-gray-600 text-sm">{{ file.description }}</p>
              </div>
              <ng-container *ngIf="!course.isEnrolled && file.id !== course.firstUploadedFile?.id">
                <span class="text-sm text-red-500 font-medium">Locked</span>
              </ng-container>
            </div>
          </div>
        </div>

        <div *ngIf="!course.isEnrolled" class="mt-6 text-center">
          <p class="text-gray-700 mb-4">To access all course content, please enroll now.</p>
          <button
            class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-md font-semibold text-lg transition"
            (click)="enroll(course.id)"
          >
            Enroll Now
          </button>
        </div>

        <p *ngIf="course.isEnrolled" class="mt-6 text-green-600 font-semibold text-center">
          You are already in this course.
        </p>
      </div>
    </div>
  </ng-template>
</div>
